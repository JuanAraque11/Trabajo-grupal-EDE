"0",""
"0",""
"0","# ─── Leer shapefile de municipios de Colombia ──────────────────────────────"
"0","shp_path <- file.path(""Datos"", ""MGN_2021_COLOMBIA"", ""ADMINISTRATIVO"", ""MGN_MPIO_POLITICO.shp"")"
"0","colombia <- st_read(shp_path, quiet = TRUE)"
"0",""
"0",""
"0","# ─── Filtrar municipios del Huila ──────────────────────────────────────────"
"0","huila <- colombia %>%"
"0","  filter(DPTO_CNMBR == ""HUILA"") %>%"
"0","  mutate("
"0","    MPIO_CCDGO = str_pad(as.character(MPIO_CCDGO), width = 3, pad = ""0""),"
"0","    cod_municipio = paste0(""41"", MPIO_CCDGO)"
"0","  )"
"0",""
"0","# ─── Leer y limpiar datos NBI ──────────────────────────────────────────────"
"0","nbi_data <- read_csv(""Datos/NBI.csv"", "
"0","                     locale = locale(decimal_mark = "",""), "
"0","                     show_col_types = FALSE) %>%"
"0","  clean_names() %>%"
"0","  mutate("
"0","    clase = str_trim(str_remove(clase, "","")),                     # Limpiar comas"
"0","    cod_municipio = str_pad(as.character(cod_municipio), 5, pad = ""0"")  # Formato uniforme"
"0","  ) %>%"
"0","  filter("
"0","    str_to_lower(clase) == ""total"",   # Solo registros ""Total"""
"0","    anio == 2018                      # Solo año 2018"
"0","  )"
"0",""
"0","# ─── Join shapefile con datos NBI ──────────────────────────────────────────"
"0","huila_nbi <- left_join(huila, nbi_data, by = ""cod_municipio"")"
"0",""
"0","# ─── Crear mapa interactivo con popup ──────────────────────────────────────"
"0","tmap_mode(""view"")"
"0",""
"0","tm_shape(huila_nbi) +"
"0","  tm_polygons("
"0","    col = ""personas_nbi"",               # Puedes cambiar a otra variable"
"0","    palette = ""Reds"","
"0","    id = ""MPIO_CNMBR"","
"0","    popup.vars = c("
"0","      ""Municipio"" = ""municipio"","
"0","      ""Hacinamiento"" = ""hacinamiento"","
"0","      ""Servicios"" = ""servicios"","
"0","      ""Vivienda"" = ""vivienda"","
"0","      ""Personas NBI"" = ""personas_nbi"","
"0","      ""Inasistencia"" = ""inasistencia"","
"0","      ""Miseria"" = ""miseria"""
"0","    )"
"0","  ) +"
"0","  tm_view(set.view = c(-75.6, 2.6, 8))  # Centrar vista en Huila"
"0",""
"0",""
"0",""
