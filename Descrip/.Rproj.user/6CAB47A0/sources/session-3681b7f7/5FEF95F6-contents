---
title: "AnÃ¡lisis Exploratorio de Indicadores en el Departamento del Huila"
author: 
  - "Juan Jose Echavarria - 1001738872"
  - "Yeferson Aguilar - 1001687113"
format:
  html:
    toc: true              # Tabla de contenido Ãºtil para navegar el informe
    number-sections: true # Numera secciones (da estructura)
    theme: cosmo          # Tema visual agradable y limpio
    
editor: visual
knitr:
  opts_chunk:
    echo: false             # Oculta el cÃ³digo por defecto
    message: false          # Oculta mensajes como los de lectura de shapefile
    warning: false          # Oculta advertencias
---

## Objetivos del trabajo

El presente trabajo tiene como objetivo principal describir y visualizar los principales indicadores sociales del departamento del Huila (Colombia), empleando herramientas de anÃ¡lisis espacial y estadÃ­stico. Se busca identificar la distribuciÃ³n territorial del Ãndice de Pobreza Multidimensional (IPM), las Necesidades BÃ¡sicas Insatisfechas (NBI), y la distancia geogrÃ¡fica de cada municipio respecto a la capital departamental, Neiva. Asimismo, se pretende fortalecer la comprensiÃ³n de las desigualdades regionales a travÃ©s de visualizaciones interactivas.

------------------------------------------------------------------------

## IntroducciÃ³n

El anÃ¡lisis de indicadores sociales es una herramienta fundamental para comprender las condiciones de vida de la poblaciÃ³n y orientar decisiones en polÃ­ticas pÃºblicas. Entre estos indicadores, el Ãndice de Pobreza Multidimensional (IPM) y las Necesidades BÃ¡sicas Insatisfechas (NBI) permiten identificar carencias estructurales en aspectos clave como educaciÃ³n, salud, vivienda y servicios pÃºblicos.

Este trabajo se centra en el departamento del Huila, una regiÃ³n del sur de Colombia que presenta contrastes importantes en su desarrollo social entre municipios. Mediante el uso de datos geogrÃ¡ficos y estadÃ­sticas sociales, se busca explorar cÃ³mo varÃ­an estos indicadores dentro del departamento y quÃ© patrones territoriales se evidencian. La elecciÃ³n del Huila responde tanto a su diversidad geogrÃ¡fica como a la disponibilidad de datos recientes que permiten realizar un anÃ¡lisis actualizado.

El uso de mapas temÃ¡ticos interactivos y tÃ©cnicas de visualizaciÃ³n facilita la interpretaciÃ³n de los resultados y permite generar conclusiones Ãºtiles para la planeaciÃ³n regional y la toma de decisiones.

------------------------------------------------------------------------

## MetodologÃ­a

Se empleÃ³ el lenguaje de programaciÃ³n R como entorno principal de anÃ¡lisis, utilizando paquetes especializados como `tidyverse`, `sf`, `tmap`, `readxl` y `janitor`.\

La informaciÃ³n espacial fue tomada del shapefile oficial de municipios de Colombia, publicado por el DANE. Los datos estadÃ­sticos provinieron de archivos CSV con indicadores sociales a nivel municipal, correspondientes a los aÃ±os 2018 (NBI) y 2021 (IPM).

Enlace: <https://geoportal.dane.gov.co/geovisores/sociedad/indicadores-regionales/>

------------------------------------------------------------------------

## Procedimiento

El procedimiento realizado se puede resumir en las siguientes etapas:

1.  **Carga y procesamiento** de los archivos espaciales (`.shp`) con los lÃ­mites municipales de Colombia.
2.  **Filtrado del departamento del Huila** y transformaciÃ³n de los datos para facilitar su anÃ¡lisis.
3.  **IntegraciÃ³n de datos socioeconÃ³micos**, emparejando los cÃ³digos municipales con los registros de IPM y NBI.
4.  **CÃ¡lculo de distancias geogrÃ¡ficas** desde cada municipio hasta Neiva, utilizando proyecciones espaciales precisas.
5.  **VisualizaciÃ³n de los datos** mediante mapas temÃ¡ticos interactivos, con Ã©nfasis en la comparaciÃ³n territorial.

------------------------------------------------------------------------

## AnÃ¡lisis exploratorio de los resultados

### Ãndice de Pobreza Multidimensional (IPM) 

La visualizaciÃ³n del Ãndice de Pobreza Multidimensional (IPM) en los municipios del Huila permite identificar zonas con mayores niveles de privaciÃ³n. El IPM combina mÃºltiples dimensiones del bienestar â€”como salud, educaciÃ³n, vivienda y trabajoâ€” para ofrecer una medida mÃ¡s integral de la pobreza.

El mapa interactivo a continuaciÃ³n muestra la distribuciÃ³n del IPM, donde se observa una concentraciÃ³n de valores mÃ¡s altos (mayor pobreza) en municipios perifÃ©ricos, mientras que la capital, Neiva, presenta los niveles mÃ¡s bajos de privaciÃ³n multidimensional.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Cargar librerÃ­as
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

suppressPackageStartupMessages({
  library(tidyverse)   # Manejo de datos
  library(sf)          # Datos espaciales
  library(tmap)        # Mapas temÃ¡ticos
  library(readxl)
  library(janitor)     # Limpieza de nombres
  library(readr)       # Lectura de CSVs
  library(dplyr)
  library(stringr)
})
options(tmap.show.messages = FALSE)
```

### Mapa

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Leer shapefile de municipios de Colombia
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
shp_path <- file.path("Datos", "MGN_2021_COLOMBIA", "ADMINISTRATIVO", "MGN_MPIO_POLITICO.shp")
colombia <- st_read(shp_path, quiet = TRUE)


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Filtrar municipios del Huila
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
huila <- colombia %>%
  filter(DPTO_CNMBR == "HUILA") %>%
  mutate(
    MPIO_CCDGO = str_pad(as.character(MPIO_CCDGO), width = 3, pad = "0"),
    cod_municipio = paste0("41", MPIO_CCDGO)
  )

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Leer archivo de IPM por municipio del Huila
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ipm_data <- suppressMessages(
  read_csv(file.path("Datos", "huila_2021.csv"),
           col_types = cols(ipm = col_character()))
) %>%
  clean_names() %>%
  mutate(
    clase = str_remove_all(clase, ",")  # ğŸ‘ˆ elimina comas
  ) %>%
  filter(str_to_lower(clase) == "total") %>%
  mutate(
    ipm = str_replace(ipm, ",", "."),
    ipm = as.numeric(ipm),
    cod_municipio = as.character(cod_municipio)
  )




# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Unir shapefile con datos IPM
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
huila_ipm <- left_join(huila, ipm_data, by = "cod_municipio")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Activar modo interactivo
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
tmap_mode("view")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Crear mapa interactivo con popup
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
tm_shape(huila_ipm) +
  tm_polygons(
    col = "ipm",
    palette = "Reds",
    id = "MPIO_CNMBR",
    popup.vars = c("IPM:" = "ipm")
  ) +
  tm_view(set.view = c(-75.6, 2.6, 8))  # Â¡Usa set.view para tmap v3!

```

----------------------------------------------------------------------------------

----------------------------------------------------------------------------------

### El Ãndice de Necesidades BÃ¡sicas Insatisfechas (NBI)

El indicador de Necesidades BÃ¡sicas Insatisfechas (NBI) refleja el porcentaje de la poblaciÃ³n que carece de condiciones mÃ­nimas de vida digna. El anÃ¡lisis espacial revela patrones similares al IPM, aunque con diferencias importantes, ya que NBI enfatiza condiciones materiales como vivienda, hacinamiento, y servicios.

El siguiente mapa detalla los niveles de NBI por municipio, proporcionando una perspectiva complementaria al anÃ¡lisis de pobreza.

### Mapa

```{r, echo=FALSE, message=FALSE, warning=FALSE}


# â”€â”€â”€ Leer shapefile de municipios de Colombia â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
shp_path <- file.path("Datos", "MGN_2021_COLOMBIA", "ADMINISTRATIVO", "MGN_MPIO_POLITICO.shp")
colombia <- st_read(shp_path, quiet = TRUE)


# â”€â”€â”€ Filtrar municipios del Huila â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
huila <- colombia %>%
  filter(DPTO_CNMBR == "HUILA") %>%
  mutate(
    MPIO_CCDGO = str_pad(as.character(MPIO_CCDGO), width = 3, pad = "0"),
    cod_municipio = paste0("41", MPIO_CCDGO)
  )

# â”€â”€â”€ Leer y limpiar datos NBI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
nbi_data <- read_csv("Datos/NBI.csv", 
                     locale = locale(decimal_mark = ","), 
                     show_col_types = FALSE) %>%
  clean_names() %>%
  mutate(
    clase = str_trim(str_remove(clase, ",")),                     # Limpiar comas
    cod_municipio = str_pad(as.character(cod_municipio), 5, pad = "0")  # Formato uniforme
  ) %>%
  filter(
    str_to_lower(clase) == "total",   # Solo registros "Total"
    anio == 2018                      # Solo aÃ±o 2018
  )

# â”€â”€â”€ Join shapefile con datos NBI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
huila_nbi <- left_join(huila, nbi_data, by = "cod_municipio")

# â”€â”€â”€ Crear mapa interactivo con popup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
tmap_mode("view")

tm_shape(huila_nbi) +
  tm_polygons(
    col = "personas_nbi",               # Puedes cambiar a otra variable
    palette = "Reds",
    id = "MPIO_CNMBR",
    popup.vars = c(
      "Municipio" = "municipio",
      "Hacinamiento" = "hacinamiento",
      "Servicios" = "servicios",
      "Vivienda" = "vivienda",
      "Personas NBI" = "personas_nbi",
      "Inasistencia" = "inasistencia",
      "Miseria" = "miseria"
    )
  ) +
  tm_view(set.view = c(-75.6, 2.6, 8))  # Centrar vista en Huila



```

-----------------------------------------------------------------------------------

-----------------------------------------------------------------------------------

### Distancia geogrÃ¡fica a Neiva

Para evaluar la relaciÃ³n entre aislamiento geogrÃ¡fico y niveles de pobreza, se calcularon las distancias desde cada municipio hasta Neiva, capital del departamento. Se observa que algunos municipios mÃ¡s alejados tambiÃ©n tienden a presentar mayores niveles de IPM y NBI, lo que sugiere un posible vÃ­nculo entre centralidad geogrÃ¡fica y acceso a oportunidades.

### Mapa

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# â”€â”€â”€ Leer shapefile y filtrar Huila â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
shp_path <- file.path("Datos", "MGN_2021_COLOMBIA", "ADMINISTRATIVO", "MGN_MPIO_POLITICO.shp")
colombia <- st_read(shp_path, quiet = TRUE)


huila <- colombia %>%
  filter(DPTO_CNMBR == "HUILA") %>%
  mutate(
    MPIO_CCDGO = str_pad(as.character(MPIO_CCDGO), 3, pad = "0"),
    cod_municipio = paste0("41", MPIO_CCDGO)
  )

# â”€â”€â”€ Reproyectar todo al CRS EPSG:3116 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
huila_proj <- st_transform(huila, crs = 3116)

# â”€â”€â”€ Calcular centroides de todos y de Neiva â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
huila_proj <- huila_proj %>%
  mutate(centroide = st_centroid(geometry))

neiva_centroid <- huila_proj %>%
  filter(MPIO_CNMBR == "NEIVA") %>%
  pull(centroide)

# â”€â”€â”€ Calcular distancias desde cada municipio a Neiva â”€â”€â”€â”€â”€â”€â”€â”€
huila_dist <- huila_proj %>%
  mutate(
    distancia_km = as.numeric(st_distance(centroide, neiva_centroid)) / 1000
  )

# â”€â”€â”€ Revisar distancias (opcional) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#print(huila_dist %>% select(MPIO_CNMBR, distancia_km))

# â”€â”€â”€ Mapa interactivo de distancias â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
tmap_mode("view")

tm_shape(huila_dist) +
  tm_polygons(
    col = "distancia_km",
    palette = "Blues",
    id = "MPIO_CNMBR",
    popup.vars = c("Distancia a Neiva (km)" = "distancia_km")
  ) +
  tm_view(set.view = c(-75.6, 2.6, 8))

```

## InterpretaciÃ³n de los resultados

El anÃ¡lisis evidencia que los municipios mÃ¡s alejados del centro urbano principal (Neiva) presentan, en general, mayores niveles de pobreza y necesidades insatisfechas. Esto podrÃ­a estar relacionado con barreras en el acceso a servicios bÃ¡sicos, educaciÃ³n, empleo formal y sistemas de salud.

Los resultados tambiÃ©n sugieren que, aunque el IPM y el NBI comparten tendencias espaciales, cada indicador captura dimensiones distintas de la pobreza, lo que refuerza la importancia de utilizarlos de manera complementaria.

## Conclusiones

-   El anÃ¡lisis geoespacial de indicadores sociales como el IPM y el NBI en el departamento del Huila permite identificar patrones territoriales de pobreza y desigualdad.

<!-- -->

-    Municipios perifÃ©ricos tienden a presentar mayores niveles de privaciÃ³n, lo que sugiere desigualdades en la distribuciÃ³n de servicios y oportunidades.

<!-- -->

-    El uso combinado de datos estadÃ­sticos y mapas interactivos facilita una mejor comprensiÃ³n de la realidad social del territorio.

<!-- -->

-    La distancia a Neiva, como capital departamental, parece correlacionarse con ciertos niveles de pobreza, aunque se requieren estudios adicionales para establecer relaciones causales.

## Recomendaciones

-   Desarrollar polÃ­ticas pÃºblicas territoriales que prioricen a los municipios mÃ¡s vulnerables y alejados del centro urbano.

<!-- -->

-    Fortalecer los sistemas de recolecciÃ³n y actualizaciÃ³n de datos socioeconÃ³micos a nivel municipal para una mejor toma de decisiones.

<!-- -->

-    Promover el uso de herramientas de anÃ¡lisis geoespacial en el diseÃ±o y monitoreo de programas sociales.

<!-- -->

-    Fomentar investigaciones interdisciplinares que analicen el vÃ­nculo entre ubicaciÃ³n geogrÃ¡fica, infraestructura y bienestar social.

## BibliografÃ­a / CibergrafÃ­a

-   DANE - Indicadores Regionales. <https://geoportal.dane.gov.co/geovisores/sociedad/indicadores-regionales/>

<!-- -->

-    DANE - Mapa de Indicadores. <https://geoportal.dane.gov.co/servicios/mapa-indicadores/>

<!-- -->

-    DANE - Datos GeoestadÃ­sticos. <https://geoportal.dane.gov.co/servicios/descarga-y-metadatos/datos-geoestadisticos/>
